<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Cline Development Metrics Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-gradient {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .metric-card {
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .export-btn {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255,107,107,0.3);
        }
        
        #screenshot-area {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Export Buttons (Outside screenshot area) -->
    <div class="fixed top-4 right-4 z-50 space-y-2">
        <button onclick="exportImage('twitter')" class="export-btn text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg">
            📱 Twitter
        </button>
        <button onclick="exportImage('linkedin')" class="export-btn text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg">
            💼 LinkedIn
        </button>
        <button onclick="exportImage('github')" class="export-btn text-white px-4 py-2 rounded-lg font-semibold text-sm shadow-lg">
            📊 GitHub
        </button>
    </div>

    <!-- Screenshot Area -->
    <div id="screenshot-area" class="min-h-screen gradient-bg p-8">
        <div class="max-w-6xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-5xl font-black text-white mb-4">
                    🚀 AI Development Metrics
                </h1>
                <p class="text-xl text-white/80 font-medium">
                    Sophisticated Code Analysis & ROI Dashboard
                </p>
                <p class="text-sm text-white/60 mt-2" id="generated-date">
                    Generated on: Loading...
                </p>
            </div>

            <!-- Hero Metrics Row -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="metric-card card-gradient rounded-2xl p-6 text-center text-white">
                    <div class="text-4xl font-black mb-2" id="total-value">$0</div>
                    <div class="text-sm font-medium opacity-80">Value Created</div>
                </div>
                <div class="metric-card card-gradient rounded-2xl p-6 text-center text-white">
                    <div class="text-4xl font-black mb-2" id="roi-ratio">0:1</div>
                    <div class="text-sm font-medium opacity-80">ROI Ratio</div>
                </div>
                <div class="metric-card card-gradient rounded-2xl p-6 text-center text-white">
                    <div class="text-4xl font-black mb-2" id="total-hours">0h</div>
                    <div class="text-sm font-medium opacity-80">Development Time</div>
                </div>
                <div class="metric-card card-gradient rounded-2xl p-6 text-center text-white">
                    <div class="text-4xl font-black mb-2" id="cost-per-hour">$0</div>
                    <div class="text-sm font-medium opacity-80">Cost per Hour</div>
                </div>
            </div>

            <!-- Secondary Metrics Row -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-8">
                <div class="card-gradient rounded-xl p-4 text-center text-white">
                    <div class="text-2xl font-bold mb-1" id="lines-added">0</div>
                    <div class="text-xs opacity-70">Lines Added</div>
                </div>
                <div class="card-gradient rounded-xl p-4 text-center text-white">
                    <div class="text-2xl font-bold mb-1" id="files-created">0</div>
                    <div class="text-xs opacity-70">Files Created</div>
                </div>
                <div class="card-gradient rounded-xl p-4 text-center text-white">
                    <div class="text-2xl font-bold mb-1" id="total-sessions">0</div>
                    <div class="text-xs opacity-70">Sessions</div>
                </div>
                <div class="card-gradient rounded-xl p-4 text-center text-white">
                    <div class="text-2xl font-bold mb-1" id="lines-per-hour">0</div>
                    <div class="text-xs opacity-70">Lines/Hour</div>
                </div>
                <div class="card-gradient rounded-xl p-4 text-center text-white">
                    <div class="text-2xl font-bold mb-1" id="value-ratio">0x</div>
                    <div class="text-xs opacity-70">Output Multiplier</div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Language Breakdown Chart -->
                <div class="card-gradient rounded-2xl p-6">
                    <h3 class="text-white font-bold text-lg mb-4">🔧 Technology Stack</h3>
                    <div class="relative h-64">
                        <canvas id="languageChart"></canvas>
                    </div>
                </div>

                <!-- Code Quality Chart -->
                <div class="card-gradient rounded-2xl p-6">
                    <h3 class="text-white font-bold text-lg mb-4">✨ Code Quality Metrics</h3>
                    <div class="relative h-64">
                        <canvas id="qualityChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Bottom Stats -->
            <div class="card-gradient rounded-2xl p-6">
                <h3 class="text-white font-bold text-lg mb-4">📈 Development Insights</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-white">
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-2" id="api-cost">$0</div>
                        <div class="text-sm opacity-80">Total API Investment</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-2" id="efficiency-score">0%</div>
                        <div class="text-sm opacity-80">Code Development %</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold mb-2" id="quality-score">0%</div>
                        <div class="text-sm opacity-80">Average Code Quality</div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="text-center mt-8">
                <p class="text-white/60 text-sm">
                    Powered by Cline AI • Advanced Development Analytics
                </p>
            </div>
        </div>
    </div>

    <script>
        // Embedded dashboard data
        let dashboardData = {
          "summary": {
            "total_sessions": 438,
            "total_hours": 2309.0,
            "total_api_cost": 1387.27,
            "total_value_created": 478739.0,
            "roi_ratio": 345.0,
            "value_ratio": 2.59,
            "lines_added": 499402,
            "files_created": 1240,
            "files_modified": 5196,
            "cost_per_hour": 0.6,
            "lines_per_hour": 216.3
          },
          "time_allocation": {
            "memory_bank_pct": 10.6,
            "project_code_pct": 74.3,
            "other_pct": 15.1
          },
          "language_breakdown": {
            "python": {
              "count": 1724,
              "lines": 121326,
              "avg_complexity": 1.9
            },
            "html": {
              "count": 28,
              "lines": 2148,
              "avg_complexity": 1.0
            },
            "typescript": {
              "count": 2332,
              "lines": 180848,
              "avg_complexity": 1.4
            },
            "css": {
              "count": 92,
              "lines": 12219,
              "avg_complexity": 1.0
            },
            "javascript": {
              "count": 119,
              "lines": 6094,
              "avg_complexity": 1.1
            },
            "sql": {
              "count": 3,
              "lines": 64,
              "avg_complexity": 1.0
            }
          },
          "quality_metrics": {
            "total_files": 4298,
            "error_handling_pct": 34.7,
            "comments_pct": 42.6,
            "modular_pct": 40.3,
            "typed_pct": 69.6
          },
          "generated_at": "2025-06-10T01:12:47.408123"
        };
        let languageChart, qualityChart;

        // Load dashboard data
        function loadData() {
            updateMetrics();
            createCharts();
        }

        function updatePlaceholderData() {
            document.getElementById('total-value').textContent = '$14,680';
            document.getElementById('roi-ratio').textContent = '162:1';
            document.getElementById('total-hours').textContent = '43.0h';
            document.getElementById('cost-per-hour').textContent = '$2.10';
            document.getElementById('lines-added').textContent = '2,847';
            document.getElementById('files-created').textContent = '47';
            document.getElementById('total-sessions').textContent = '20';
            document.getElementById('lines-per-hour').textContent = '66';
            document.getElementById('value-ratio').textContent = '4.3x';
            document.getElementById('api-cost').textContent = '$90.54';
            document.getElementById('efficiency-score').textContent = '78%';
            document.getElementById('quality-score').textContent = '85%';
            document.getElementById('generated-date').textContent = `Generated on: ${new Date().toLocaleDateString()}`;
        }

        function updateMetrics() {
            if (!dashboardData.summary) return;

            const s = dashboardData.summary;
            
            document.getElementById('total-value').textContent = `$${s.total_value_created?.toLocaleString() || '0'}`;
            document.getElementById('roi-ratio').textContent = `${s.roi_ratio || '0'}:1`;
            document.getElementById('total-hours').textContent = `${s.total_hours || '0'}h`;
            document.getElementById('cost-per-hour').textContent = `$${s.cost_per_hour || '0'}`;
            document.getElementById('lines-added').textContent = (s.lines_added || 0).toLocaleString();
            document.getElementById('files-created').textContent = s.files_created || '0';
            document.getElementById('total-sessions').textContent = s.total_sessions || '0';
            document.getElementById('lines-per-hour').textContent = s.lines_per_hour || '0';
            document.getElementById('value-ratio').textContent = `${s.value_ratio || '0'}x`;
            document.getElementById('api-cost').textContent = `$${s.total_api_cost || '0'}`;
            
            // Calculate efficiency
            const timeAlloc = dashboardData.time_allocation || {};
            const efficiency = timeAlloc.project_code_pct || 0;
            document.getElementById('efficiency-score').textContent = `${Math.round(efficiency)}%`;
            
            // Calculate quality score
            const quality = dashboardData.quality_metrics || {};
            const avgQuality = (
                (quality.error_handling_pct || 0) +
                (quality.comments_pct || 0) +
                (quality.modular_pct || 0) +
                (quality.typed_pct || 0)
            ) / 4;
            document.getElementById('quality-score').textContent = `${Math.round(avgQuality)}%`;
            
            document.getElementById('generated-date').textContent = 
                `Generated on: ${new Date(dashboardData.generated_at || Date.now()).toLocaleDateString()}`;
        }

        function createCharts() {
            createLanguageChart();
            createQualityChart();
        }

        function createLanguageChart() {
            const ctx = document.getElementById('languageChart').getContext('2d');
            const languages = dashboardData.language_breakdown || {};
            
            const labels = Object.keys(languages);
            const data = labels.map(lang => languages[lang].lines || 0);
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FECA57', '#FF9FF3'];

            if (languageChart) languageChart.destroy();
            
            languageChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels.map(l => l.charAt(0).toUpperCase() + l.slice(1)),
                    datasets: [{
                        data: data,
                        backgroundColor: colors.slice(0, labels.length),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: 'white', font: { size: 12 } }
                        }
                    }
                }
            });
        }

        function createQualityChart() {
            const ctx = document.getElementById('qualityChart').getContext('2d');
            const quality = dashboardData.quality_metrics || {};
            
            if (qualityChart) qualityChart.destroy();
            
            qualityChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Error Handling', 'Comments', 'Modular Design', 'Type Annotations'],
                    datasets: [{
                        label: 'Code Quality',
                        data: [
                            quality.error_handling_pct || 0,
                            quality.comments_pct || 0,
                            quality.modular_pct || 0,
                            quality.typed_pct || 0
                        ],
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        borderColor: 'rgba(78, 205, 196, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(78, 205, 196, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { color: 'white' },
                            grid: { color: 'rgba(255,255,255,0.2)' },
                            pointLabels: { color: 'white', font: { size: 11 } }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        // Export functionality
        async function exportImage(format) {
            const element = document.getElementById('screenshot-area');
            const button = event.target;
            
            // Show loading state
            const originalText = button.textContent;
            button.textContent = '📸 Capturing...';
            button.disabled = true;

            try {
                const canvas = await html2canvas(element, {
                    backgroundColor: null,
                    scale: 2,
                    useCORS: true,
                    allowTaint: true
                });

                // Create download link
                const link = document.createElement('a');
                link.download = `cline-metrics-${format}-${new Date().toISOString().split('T')[0]}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // Success feedback
                button.textContent = '✅ Saved!';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Export failed:', error);
                button.textContent = '❌ Failed';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.disabled = false;
                }, 2000);
            }
        }

        // Initialize
        loadData();
    </script>
</body>
</html>
